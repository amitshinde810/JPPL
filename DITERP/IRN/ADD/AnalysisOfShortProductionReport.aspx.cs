﻿using System;
using System.Data;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using CrystalDecisions.CrystalReports.Engine;

public partial class IRN_ADD_AnalysisOfShortProductionReport : System.Web.UI.Page
{
    DatabaseAccessLayer DL_DBAccess = null;
    public static string strUser = "";
    protected void Page_Load(object sender, EventArgs e)
    {
        HtmlGenericControl home = (HtmlGenericControl)this.Page.Master.FindControl("Menus").FindControl("COPP");
        home.Attributes["class"] = "active";
        HtmlGenericControl home1 = (HtmlGenericControl)this.Page.Master.FindControl("Menus").FindControl("COPPMV");
        home1.Attributes["class"] = "active";
    }

    #region Page_Init
    protected void Page_Init(object sender, EventArgs e)
    {
        try
        {
            ViewState["strUser"] = strUser;
            if (!IsPostBack)
            {
                ViewState["strUser"] = "0";
            }
            string Title = Request.QueryString[0];
            string From = Request.QueryString[1].ToString();
            string Todt = Request.QueryString[2].ToString();
            string i_name = Request.QueryString[3].ToString();
            string Type = Request.QueryString[4].ToString();
            string Cond = Request.QueryString[5].ToString();
            string Line = Request.QueryString[6].ToString();

            GenerateReport(Title, From, Todt, i_name, Type, Cond, Line);
        }
        catch (Exception Ex)
        {
            CommonClasses.SendError("Issue To Production Register", "btnCancel_Click", Ex.Message);
        }
    }
    #endregion

    #region GenerateReport
    private void GenerateReport(string Title, string From, string Todt, string i_name, string Type, string Cond, string Line)
    {
        try
        {
            DL_DBAccess = new DatabaseAccessLayer();
            string Query = "";

            TimeSpan t = Convert.ToDateTime(Todt) - Convert.ToDateTime(From);
            int DaysInMonth = (t.Days);
            if (i_name == "0")
            {
                //Query = "SELECT * INTO #Temp FROM (SELECT ID.IRND_I_CODE,ITEM_MASTER.I_CODENO,ITEM_MASTER.I_NAME,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION_Comm,ISNULL(ID.IRND_STANDARD_PROD,0) AS IRND_STANDARD_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD_Cumm,ISNULL((SELECT SUM(IRND_PROD_QTY)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTY, ISNULL((SELECT SUM(IRND_PROD_QTY) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_Cumm  ,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS SQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483647)),0) AS SQTY_TOOLROOM,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483646)),0) AS SQTY_DIE , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS SQTY_CONTRACTOR  ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS SQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483643)),0) AS SQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS SQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483641)),0) AS SQTY_MAINTENANCE,    ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS SQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS SQTY_IMPROVEMENT ,  ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS CUMMSQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483647)),0) AS CUMMSQTY_TOOLROOM, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483646)),0) AS CUMMSQTY_DIE ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS CUMMSQTY_CONTRACTOR  ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS CUMMSQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483643)),0) AS CUMMSQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS CUMMSQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483641)),0) AS CUMMSQTY_MAINTENANCE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS CUMMSQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS CUMMSQTY_IMPROVEMENT  FROM IRN_ENTRY AS IE INNER JOIN IRN_DETAIL AS ID ON IE.IRN_CODE=ID.IRND_IRN_CODE INNER JOIN ITEM_MASTER ON ID.IRND_I_CODE=ITEM_MASTER.I_CODE WHERE (IE.ES_DELETE=0) AND (IE.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND IE.IRN_TRANS_TYPE=1 AND IE.IRN_TYPE=0 ) AS TempDetail SELECT IRND_I_CODE,I_CODENO,I_NAME,sum(ISNULL(I_STANDARD_PRODUCTION,0)) AS I_STANDARD_PRODUCTION,sum(ISNULL(I_STANDARD_PRODUCTION_Comm,0)) AS I_STANDARD_PRODUCTION_Cumm,SUM(ISNULL(IRND_SHORT_PROD,0)) AS IRND_SHORT_PROD,SUM(ISNULL(IRND_STANDARD_PROD	,0)) AS IRND_STANDARD_PROD,SUM(ISNULL(IRND_PROD_QTY,0)) AS IRND_PROD_QTY,SUM(ISNULL(SQTY_MELTING,0)) AS SQTY_MELTING,SUM(ISNULL(SQTY_TOOLROOM,0)) AS SQTY_TOOLROOM,SUM(ISNULL(SQTY_DIE,0)) AS SQTY_DIE,SUM(ISNULL(SQTY_CONTRACTOR,0)) AS SQTY_CONTRACTOR,SUM(ISNULL(SQTY_CORESHOP,0)) AS SQTY_CORESHOP,SUM(ISNULL(SQTY_PURCHASE,0)) AS SQTY_PURCHASE,SUM(ISNULL(SQTY_PLAN,0)) AS SQTY_PLAN,SUM(ISNULL(SQTY_MAINTENANCE,0)) AS SQTY_MAINTENANCE,SUM(ISNULL(SQTY_REJECTION,0)) AS SQTY_REJECTION,SUM(ISNULL(SQTY_IMPROVEMENT,0)) AS SQTY_IMPROVEMENT,SUM(ISNULL(CUMMSQTY_MELTING,0)) AS CUMMSQTY_MELTING,SUM(ISNULL(CUMMSQTY_TOOLROOM,0)) AS CUMMSQTY_TOOLROOM,SUM(ISNULL(CUMMSQTY_DIE,0)) AS CUMMSQTY_DIE,SUM(ISNULL(CUMMSQTY_CONTRACTOR,0)) AS CUMMSQTY_CONTRACTOR,SUM(ISNULL(CUMMSQTY_CORESHOP,0)) AS CUMMSQTY_CORESHOP,SUM(ISNULL(CUMMSQTY_PURCHASE,0)) AS CUMMSQTY_PURCHASE,SUM(ISNULL(CUMMSQTY_PLAN,0)) AS CUMMSQTY_PLAN,SUM(ISNULL(CUMMSQTY_MAINTENANCE	,0)) AS CUMMSQTY_MAINTENANCE,SUM(ISNULL(CUMMSQTY_REJECTION,0)) AS CUMMSQTY_REJECTION,SUM(ISNULL(CUMMSQTY_IMPROVEMENT,0)) AS CUMMSQTY_IMPROVEMENT,SUM(ISNULL(IRND_PROD_QTY_Cumm,0)) AS IRND_PROD_QTY_Cumm ,SUM(ISNULL(IRND_SHORT_PROD_Cumm,0)) AS IRND_SHORT_PROD_Cumm FROM #Temp GROUP BY IRND_I_CODE,I_CODENO,I_NAME ORDER BY I_NAME DROP TABLE #Temp";
                Query = "SELECT * INTO #Temp FROM (SELECT ID.IRND_I_CODE,ITEM_MASTER.I_CODENO,ITEM_MASTER.I_NAME,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION_Comm,ISNULL(ID.IRND_STANDARD_PROD,0) AS IRND_STANDARD_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD_Cumm,ISNULL((SELECT  SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_STANDARD_PROD else IRND_PROD_QTY END  )  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTYACT,ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_STANDARD_PROD else IRND_PROD_QTY END  ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE)  AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_CummACT  ,     ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_PROD_QTY-IRND_STANDARD_PROD else 0 END  )  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTYEXcess, ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_PROD_QTY-IRND_STANDARD_PROD else 0 END  ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_CummEXcess,ISNULL((SELECT SUM(IRND_PROD_QTY) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE= '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTY, ISNULL((SELECT SUM( IRND_PROD_QTY ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_Cumm , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=-2147483648)),0) AS SQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483647)),0) AS SQTY_TOOLROOM,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483646)),0) AS SQTY_DIE,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483638)),0) AS SQTY_ACL_PLAN,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS SQTY_CONTRACTOR  ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS SQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483643)),0) AS SQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS SQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483641)),0) AS SQTY_MAINTENANCE,    ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS SQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS SQTY_IMPROVEMENT ,  ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS CUMMSQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483647)),0) AS CUMMSQTY_TOOLROOM, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483646)),0) AS CUMMSQTY_DIE ,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND  '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483638)),0) AS CUMMSQTY_ACL_PLAN,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE= - 2147483645)),0) AS CUMMSQTY_CONTRACTOR,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483644)),0) AS CUMMSQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483643)),0) AS CUMMSQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483642)),0) AS CUMMSQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483641)),0) AS CUMMSQTY_MAINTENANCE,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483640)),0) AS CUMMSQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483639)),0) AS CUMMSQTY_IMPROVEMENT FROM IRN_ENTRY AS IE INNER JOIN IRN_DETAIL AS ID ON IE.IRN_CODE=ID.IRND_IRN_CODE INNER JOIN ITEM_MASTER ON ID.IRND_I_CODE=ITEM_MASTER.I_CODE INNER JOIN LINE_CHANGE ON ID.IRND_I_CODE = LINE_CHANGE.LC_I_CODE WHERE " + Cond + " LC_ACTIVE=1 AND (IE.ES_DELETE=0) AND (IE.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND IE.IRN_TRANS_TYPE=1 AND IE.IRN_TYPE=0 ) AS TempDetail SELECT IRND_I_CODE,I_CODENO,I_NAME,sum(ISNULL(I_STANDARD_PRODUCTION,0)) AS I_STANDARD_PRODUCTION,sum(ISNULL(I_STANDARD_PRODUCTION_Comm,0)) AS I_STANDARD_PRODUCTION_Cumm,SUM(ISNULL(IRND_SHORT_PROD,0)) AS IRND_SHORT_PROD,SUM(ISNULL(IRND_STANDARD_PROD,0)) AS IRND_STANDARD_PROD,SUM(ISNULL(IRND_PROD_QTY,0)) AS IRND_PROD_QTY,SUM(ISNULL(SQTY_MELTING,0)) AS SQTY_MELTING,SUM(ISNULL(SQTY_TOOLROOM,0)) AS SQTY_TOOLROOM,SUM(ISNULL(SQTY_DIE,0)) AS SQTY_DIE,SUM(ISNULL(SQTY_ACL_PLAN,0)) AS SQTY_ACL_PLAN,SUM(ISNULL(SQTY_CONTRACTOR,0)) AS SQTY_CONTRACTOR,SUM(ISNULL(SQTY_CORESHOP,0)) AS SQTY_CORESHOP,SUM(ISNULL(SQTY_PURCHASE,0)) AS SQTY_PURCHASE,SUM(ISNULL(SQTY_PLAN,0)) AS SQTY_PLAN,SUM(ISNULL(SQTY_MAINTENANCE,0)) AS SQTY_MAINTENANCE,SUM(ISNULL(SQTY_REJECTION,0)) AS SQTY_REJECTION,SUM(ISNULL(SQTY_IMPROVEMENT,0)) AS SQTY_IMPROVEMENT,SUM(ISNULL(CUMMSQTY_MELTING,0)) AS CUMMSQTY_MELTING,SUM(ISNULL(CUMMSQTY_TOOLROOM,0)) AS CUMMSQTY_TOOLROOM,SUM(ISNULL(CUMMSQTY_DIE,0)) AS CUMMSQTY_DIE,SUM(ISNULL(CUMMSQTY_ACL_PLAN,0)) AS CUMMSQTY_ACL_PLAN,SUM(ISNULL(CUMMSQTY_CONTRACTOR,0)) AS CUMMSQTY_CONTRACTOR,SUM(ISNULL(CUMMSQTY_CORESHOP,0)) AS CUMMSQTY_CORESHOP,SUM(ISNULL(CUMMSQTY_PURCHASE,0)) AS CUMMSQTY_PURCHASE,SUM(ISNULL(CUMMSQTY_PLAN,0)) AS CUMMSQTY_PLAN,SUM(ISNULL(CUMMSQTY_MAINTENANCE,0)) AS CUMMSQTY_MAINTENANCE,SUM(ISNULL(CUMMSQTY_REJECTION,0)) AS CUMMSQTY_REJECTION,SUM(ISNULL(CUMMSQTY_IMPROVEMENT,0)) AS CUMMSQTY_IMPROVEMENT,SUM(ISNULL(IRND_PROD_QTY_Cumm,0)) AS IRND_PROD_QTY_Cumm ,SUM(ISNULL(IRND_SHORT_PROD_Cumm,0)) AS IRND_SHORT_PROD_Cumm ,-SUM(ISNULL(IRND_PROD_QTYEXcess,0)) AS IRND_PROD_QTYEXcess ,-SUM(ISNULL(IRND_PROD_QTY_CummEXcess,0)) AS IRND_PROD_QTY_CummEXcess ,SUM(ISNULL(IRND_PROD_QTYACT,0)) AS IRND_PROD_QTYACT ,SUM(ISNULL(IRND_PROD_QTY_CummACT,0)) AS IRND_PROD_QTY_CummACT FROM #Temp GROUP BY IRND_I_CODE,I_CODENO,I_NAME ORDER BY I_NAME DROP TABLE #Temp";
            }
            else
            {
                //Query = "SELECT * INTO #Temp FROM (SELECT DISTINCT  ID.IRND_I_CODE,ITEM_MASTER.I_CODENO,ITEM_MASTER.I_NAME,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION_Comm,ISNULL(ID.IRND_STANDARD_PROD,0) AS IRND_STANDARD_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD_Cumm,ISNULL((SELECT SUM(IRND_PROD_QTY)  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTY, ISNULL((SELECT SUM(IRND_PROD_QTY) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_Cumm  ,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS SQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483647)),0) AS SQTY_TOOLROOM,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483646)),0) AS SQTY_DIE ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS SQTY_CONTRACTOR  ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS SQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483643)),0) AS SQTY_PURCHASE,ISNULL((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS SQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483641)),0) AS SQTY_MAINTENANCE,    ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS SQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS SQTY_IMPROVEMENT ,  ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS CUMMSQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483647)),0) AS CUMMSQTY_TOOLROOM, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483646)),0) AS CUMMSQTY_DIE ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS CUMMSQTY_CONTRACTOR  ,   ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS CUMMSQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483643)),0) AS CUMMSQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS CUMMSQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483641)),0) AS CUMMSQTY_MAINTENANCE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS CUMMSQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS CUMMSQTY_IMPROVEMENT  FROM IRN_ENTRY AS IE INNER JOIN IRN_DETAIL AS ID ON IE.IRN_CODE=ID.IRND_IRN_CODE INNER JOIN ITEM_MASTER ON ID.IRND_I_CODE=ITEM_MASTER.I_CODE WHERE (IE.ES_DELETE=0) AND (IE.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND IE.IRN_TRANS_TYPE=1 AND IE.IRN_TYPE=0 AND ITEM_MASTER.I_CODE='" + i_name + "') AS TempDetail SELECT IRND_I_CODE,I_CODENO,I_NAME,sum(ISNULL(I_STANDARD_PRODUCTION,0)) AS I_STANDARD_PRODUCTION,sum(ISNULL(I_STANDARD_PRODUCTION_Comm,0)) AS I_STANDARD_PRODUCTION_Cumm,SUM(ISNULL(IRND_SHORT_PROD,0)) AS IRND_SHORT_PROD,SUM(ISNULL(IRND_STANDARD_PROD	,0)) AS IRND_STANDARD_PROD,SUM(ISNULL(IRND_PROD_QTY,0)) AS IRND_PROD_QTY,SUM(ISNULL(SQTY_MELTING,0)) AS SQTY_MELTING,SUM(ISNULL(SQTY_TOOLROOM,0)) AS SQTY_TOOLROOM,SUM(ISNULL(SQTY_DIE,0)) AS SQTY_DIE,SUM(ISNULL(SQTY_CONTRACTOR,0)) AS SQTY_CONTRACTOR,SUM(ISNULL(SQTY_CORESHOP,0)) AS SQTY_CORESHOP,SUM(ISNULL(SQTY_PURCHASE,0)) AS SQTY_PURCHASE,SUM(ISNULL(SQTY_PLAN,0)) AS SQTY_PLAN,SUM(ISNULL(SQTY_MAINTENANCE,0)) AS SQTY_MAINTENANCE,SUM(ISNULL(SQTY_REJECTION,0)) AS SQTY_REJECTION,SUM(ISNULL(SQTY_IMPROVEMENT,0)) AS SQTY_IMPROVEMENT,SUM(ISNULL(CUMMSQTY_MELTING,0)) AS CUMMSQTY_MELTING,SUM(ISNULL(CUMMSQTY_TOOLROOM,0)) AS CUMMSQTY_TOOLROOM,SUM(ISNULL(CUMMSQTY_DIE,0)) AS CUMMSQTY_DIE,SUM(ISNULL(CUMMSQTY_CONTRACTOR,0)) AS CUMMSQTY_CONTRACTOR,SUM(ISNULL(CUMMSQTY_CORESHOP,0)) AS CUMMSQTY_CORESHOP,SUM(ISNULL(CUMMSQTY_PURCHASE,0)) AS CUMMSQTY_PURCHASE,SUM(ISNULL(CUMMSQTY_PLAN,0)) AS CUMMSQTY_PLAN,SUM(ISNULL(CUMMSQTY_MAINTENANCE	,0)) AS CUMMSQTY_MAINTENANCE,SUM(ISNULL(CUMMSQTY_REJECTION,0)) AS CUMMSQTY_REJECTION,SUM(ISNULL(CUMMSQTY_IMPROVEMENT,0)) AS CUMMSQTY_IMPROVEMENT,SUM(ISNULL(IRND_PROD_QTY_Cumm,0)) AS IRND_PROD_QTY_Cumm ,SUM(ISNULL(IRND_SHORT_PROD_Cumm,0)) AS IRND_SHORT_PROD_Cumm FROM #Temp  GROUP BY IRND_I_CODE,I_CODENO,I_NAME ORDER BY I_NAME  DROP TABLE #Temp";
                Query = "SELECT * INTO #Temp FROM (SELECT ID.IRND_I_CODE,ITEM_MASTER.I_CODENO,ITEM_MASTER.I_NAME,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION,ISNULL((SELECT SUM(isnull(IRND_STANDARD_PROD,0)) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE=ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS I_STANDARD_PRODUCTION_Comm,ISNULL(ID.IRND_STANDARD_PROD,0) AS IRND_STANDARD_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD,ISNULL((SELECT SUM(IRND_SHORT_PROD) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_SHORT_PROD_Cumm,ISNULL((SELECT  SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_STANDARD_PROD else IRND_PROD_QTY END  )  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTYACT,ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_STANDARD_PROD else IRND_PROD_QTY END  ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE)  AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_CummACT  ,     ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_PROD_QTY-IRND_STANDARD_PROD else 0 END  )  FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTYEXcess, ISNULL((SELECT SUM(CASE WHEN IRND_PROD_QTY >IRND_STANDARD_PROD then IRND_PROD_QTY-IRND_STANDARD_PROD else 0 END  ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_CummEXcess ,ISNULL((SELECT SUM(IRND_PROD_QTY) FROM IRN_ENTRY INNER JOIN IRN_DETAIL ON IRN_CODE=IRND_IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE= '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) ),0) AS IRND_PROD_QTY, ISNULL((SELECT SUM( IRND_PROD_QTY ) FROM IRN_ENTRY INNER JOIN IRN_DETAIL  ON  IRN_CODE=IRND_IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_DETAIL.IRND_I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "')),0) AS IRND_PROD_QTY_Cumm , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=-2147483648)),0) AS SQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483647)),0) AS SQTY_TOOLROOM,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483646)),0) AS SQTY_DIE,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483638)),0) AS SQTY_ACL_PLAN,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483645)),0) AS SQTY_CONTRACTOR,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483644)),0) AS SQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483643)),0) AS SQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483642)),0) AS SQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483641)),0) AS SQTY_MAINTENANCE,    ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483640)),0) AS SQTY_REJECTION , ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE='" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483639)),0) AS SQTY_IMPROVEMENT ,  ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "' ) AND (IRN_SPDETAIL.SPR_CODE=   - 2147483648)),0) AS CUMMSQTY_MELTING,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483647)),0) AS CUMMSQTY_TOOLROOM,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483646)),0) AS CUMMSQTY_DIE,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN  '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483638)),0) AS CUMMSQTY_ACL_PLAN,ISNULL((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=-2147483645)),0) AS CUMMSQTY_CONTRACTOR ,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483644)),0) AS CUMMSQTY_CORESHOP,ISNULL ((SELECT SUM(SHORT_QTY)   FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=   - 2147483643)),0) AS CUMMSQTY_PURCHASE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483642)),0) AS CUMMSQTY_PLAN, ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483641)),0) AS CUMMSQTY_MAINTENANCE,ISNULL ((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN   '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483640)),0) AS CUMMSQTY_REJECTION,ISNULL((SELECT SUM(SHORT_QTY) FROM IRN_ENTRY INNER JOIN  IRN_SPDETAIL ON IRN_ENTRY.IRN_CODE=IRN_SPDETAIL.IRN_CODE  WHERE (IRN_ENTRY.IRN_CODE=IE.IRN_CODE) AND (IRN_SPDETAIL.I_CODE= ID.IRND_I_CODE) AND (IRN_ENTRY.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND (IRN_SPDETAIL.SPR_CODE=- 2147483639)),0) AS CUMMSQTY_IMPROVEMENT FROM IRN_ENTRY AS IE INNER JOIN IRN_DETAIL AS ID ON IE.IRN_CODE=ID.IRND_IRN_CODE INNER JOIN ITEM_MASTER ON ID.IRND_I_CODE=ITEM_MASTER.I_CODE INNER JOIN LINE_CHANGE ON ID.IRND_I_CODE = LINE_CHANGE.LC_I_CODE WHERE " + Cond + " LC_ACTIVE=1 AND (IE.ES_DELETE=0) AND (IE.IRN_DATE BETWEEN '" + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + "' AND '" + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy") + "') AND IE.IRN_TRANS_TYPE=1 AND IE.IRN_TYPE=0 AND ITEM_MASTER.I_CODE='" + i_name + "') AS TempDetail SELECT IRND_I_CODE,I_CODENO,I_NAME,sum(ISNULL(I_STANDARD_PRODUCTION,0)) AS I_STANDARD_PRODUCTION,sum(ISNULL(I_STANDARD_PRODUCTION_Comm,0)) AS I_STANDARD_PRODUCTION_Cumm,SUM(ISNULL(IRND_SHORT_PROD,0)) AS IRND_SHORT_PROD,SUM(ISNULL(IRND_STANDARD_PROD,0)) AS IRND_STANDARD_PROD,SUM(ISNULL(IRND_PROD_QTY,0)) AS IRND_PROD_QTY,SUM(ISNULL(SQTY_MELTING,0)) AS SQTY_MELTING,SUM(ISNULL(SQTY_TOOLROOM,0)) AS SQTY_TOOLROOM,SUM(ISNULL(SQTY_DIE,0)) AS SQTY_DIE,SUM(ISNULL(SQTY_ACL_PLAN,0)) AS SQTY_ACL_PLAN,SUM(ISNULL(SQTY_CONTRACTOR,0)) AS SQTY_CONTRACTOR,SUM(ISNULL(SQTY_CORESHOP,0)) AS SQTY_CORESHOP,SUM(ISNULL(SQTY_PURCHASE,0)) AS SQTY_PURCHASE,SUM(ISNULL(SQTY_PLAN,0)) AS SQTY_PLAN,SUM(ISNULL(SQTY_MAINTENANCE,0)) AS SQTY_MAINTENANCE,SUM(ISNULL(SQTY_REJECTION,0)) AS SQTY_REJECTION,SUM(ISNULL(SQTY_IMPROVEMENT,0)) AS SQTY_IMPROVEMENT,SUM(ISNULL(CUMMSQTY_MELTING,0)) AS CUMMSQTY_MELTING,SUM(ISNULL(CUMMSQTY_TOOLROOM,0)) AS CUMMSQTY_TOOLROOM,SUM(ISNULL(CUMMSQTY_DIE,0)) AS CUMMSQTY_DIE,SUM(ISNULL(CUMMSQTY_ACL_PLAN,0)) AS CUMMSQTY_ACL_PLAN,SUM(ISNULL(CUMMSQTY_CONTRACTOR,0)) AS CUMMSQTY_CONTRACTOR,SUM(ISNULL(CUMMSQTY_CORESHOP,0)) AS CUMMSQTY_CORESHOP,SUM(ISNULL(CUMMSQTY_PURCHASE,0)) AS CUMMSQTY_PURCHASE,SUM(ISNULL(CUMMSQTY_PLAN,0)) AS CUMMSQTY_PLAN,SUM(ISNULL(CUMMSQTY_MAINTENANCE,0)) AS CUMMSQTY_MAINTENANCE,SUM(ISNULL(CUMMSQTY_REJECTION,0)) AS CUMMSQTY_REJECTION,SUM(ISNULL(CUMMSQTY_IMPROVEMENT,0)) AS CUMMSQTY_IMPROVEMENT,SUM(ISNULL(IRND_PROD_QTY_Cumm,0)) AS IRND_PROD_QTY_Cumm ,SUM(ISNULL(IRND_SHORT_PROD_Cumm,0)) AS IRND_SHORT_PROD_Cumm ,-SUM(ISNULL(IRND_PROD_QTYEXcess,0)) AS IRND_PROD_QTYEXcess ,-SUM(ISNULL(IRND_PROD_QTY_CummEXcess,0)) AS IRND_PROD_QTY_CummEXcess ,SUM(ISNULL(IRND_PROD_QTYACT,0)) AS IRND_PROD_QTYACT ,SUM(ISNULL(IRND_PROD_QTY_CummACT,0)) AS IRND_PROD_QTY_CummACT FROM #Temp GROUP BY IRND_I_CODE,I_CODENO,I_NAME ORDER BY I_NAME DROP TABLE #Temp";
            }
            DataSet ds = new DataSet();
            DataTable dt = new DataTable();

            string strLine = "";
            if (Line != "Select Line Name")
            {
                strLine = Line;
            }
            dt = CommonClasses.Execute(Query);
            if (dt.Rows.Count > 0)
            {
                ReportDocument rptname = null;
                rptname = new ReportDocument();
                rptname.Load(Server.MapPath("~/Reports/AnalysisOfShortProd.rpt")); //foundaryRejYearly
                rptname.FileName = Server.MapPath("~/Reports/AnalysisOfShortProd.rpt");
                rptname.Refresh();
                rptname.SetDataSource(dt);
                rptname.SetParameterValue("txtCompName", Session["CompanyName"].ToString());
                rptname.SetParameterValue("txtDaysInMonth", DaysInMonth);
                rptname.SetParameterValue("txtPeriod", "ANALYSIS OF SHORT PRODUCTION REPORT " + strLine + " From " + Convert.ToDateTime(From).ToString("dd/MMM/yyyy") + " To " + Convert.ToDateTime(Todt).ToString("dd/MMM/yyyy"));
                CrystalReportViewer1.ReportSource = rptname;
                CrystalReportViewer1.ID = Title.Replace(" ", "_");
            }
            else
            {
                PanelMsg.Visible = true;
                lblmsg.Text = "Record Not Found";
                return;
            }
        }
        catch (Exception Ex)
        {
        }
    }
    #endregion

    #region ShowMessage
    public bool ShowMessage(string DiveName, string Message, string MessageType)
    {
        try
        {
            if ((!ClientScript.IsStartupScriptRegistered("regMostrarMensagem")))
            {
                Page.ClientScript.RegisterStartupScript(this.GetType(), "regMostrarMensagem", "MostrarMensagem('" + DiveName + "','" + Message + "','" + MessageType + "');", true);
            }
            return true;
        }
        catch (Exception Ex)
        {
            CommonClasses.SendError("Customer Rejection Register", "ShowMessage", Ex.Message);
            return false;
        }
    }
    #endregion

    #region btnCancel_Click
    protected void btnCancel_Click(object sender, EventArgs e)
    {
        try
        {
            Response.Redirect("~/IRN/VIEW/ViewAnalysisOfShortProductionReport.aspx", false);
        }
        catch (Exception Ex)
        {
            CommonClasses.SendError("Customer Rejection Register", "btnCancel_Click", Ex.Message);
        }
    }
    #endregion
}
